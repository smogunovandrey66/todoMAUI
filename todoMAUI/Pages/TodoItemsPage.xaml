<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModel="clr-namespace:todoMAUI.PageModels"
             xmlns:models="clr-namespace:todoMAUI.Models"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="todoMAUI.Pages.TodoItemsPage"
             x:DataType="pageModel:TodoItemsModel"
             xmlns:controls="clr-namespace:todoMAUI.Pages.Controls"
             Title="NewPage1">

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
            EventName="Appearing"
            Command="{Binding AppearingCommand}"/>
    </ContentPage.Behaviors>
    
    <VerticalStackLayout>
        <Label
            Text="TODOs на MAUI"
            HorizontalOptions="Center"
            Padding="5"
            TextDecorations="Underline"/>
        <Grid ColumnDefinitions="*, Auto">
            <Entry
                x:Name="taskEntry" 
                Placeholder="Enter task..." 
                Grid.Column="0" 
                Margin="5"
                Text="{Binding Title}"/>
            <Button Text="Add" 
                    Clicked="OnAddClicked" 
                    Grid.Column="1" Margin="5" 
                    Command="{Binding AddItemCommand}"/>
            <!-- Не рекомендуемый в MVVM подход для передачи параметров CommandParameter="{Binding Source={x:Reference taskEntry}, Path=Text}" -->
        </Grid>
        <CollectionView x:Name="todoItemsList" ItemsSource="{Binding TodoItems}">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:TodoItem">
                    <SwipeView>
                        <SwipeView.RightItems>
                            <SwipeItems>
                                <SwipeItem
                                   Text="Delete"
                                    BackgroundColor="Red"
                                    Command="{Binding DeleteItemCommand, Source={RelativeSource AncestorType={x:Type pageModel:TodoItemsModel}}, x:DataType=pageModel:TodoItemsModel}"
                                    CommandParameter="{Binding .}"
                                />
                            </SwipeItems>
                        </SwipeView.RightItems>

                        <!--<Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer
                                    Command="{Binding ItemClickCommand, Source={RelativeSource AncestorType={x:Type pageModel:TodoItemsModel}}, x:DataType=pageModel:TodoItemsModel}"
                                    CommandParameter="{Binding .}"/>
                                <TapGestureRecognizer
                                    Tapped="TapGestureRecognizer_Tapped"/>
                            </Grid.GestureRecognizers>
                            
                            <CheckBox
                                x:Name="checkBoxDone"
                                Grid.Column="0"/>
                            <Label Text="{Binding Title}"
                                Grid.Column="1"
                                   VerticalOptions="Center"/>
                        </Grid> -->
                        <controls:TodoItemView/>
                    </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </VerticalStackLayout>
</ContentPage>